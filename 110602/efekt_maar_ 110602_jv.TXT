/*15 pucle je velmi popularna hra. Isto ste ju uz videli, i ked si neviete spomenut na meno.
Hra je tvorena 15-timi posuvnymi dlazdicami, kazdy s odlisnim cislom od 1 do 15, a usporiadane v stvorci 4x4 
kde jedna dlazdica chyba. Predmetom hadanky je usporiadat dlazdice tak ako su zoradene na obrazku.
*/
/*
Iba povoleny tah ktory sa da vykonavat je vymenenie chybajucej dlazdice s ktorou zdiela hranu 2,3 alebo 4. Zvazte nasledujucu postupnost tahov.*/
/*
Oznacujeme kroky podla suseda chybajucej dlazdice s ktorou je vymeny. Tato kocka sa vymiena s kockami 
v smere Hore Dole Dolava a Doprava. Je to zalozene na pohybe a vymene diery(prazdneho policka). 
Vzhladom na vstupne zadanie 15puciel musime stnovit postupnost krokov ktora nas dovedie do konecneho stavu.
Kazde riesenie vstupov 15pucle vyzaduje nanajvys 45 krokov.ktore je potrebne vyriesits vasim hodnotiacim riesenim(zadanim)
ste obmedzeny pouzit najviac 50 krokov k vyrieseniu.*/
-------------------

//VSTUP
/*prvy riadok vstupu pozostava s celych cisiel n indikuje cislo sady vstupov puciel.
Dalsi 4n riadok obsahuje n puciel v 4och riadkoch za puzzle. Nula oznacuje chybajucu dlazdicu.*/
//VYSTUP
/*Pre kazdy vstupny subor musim predlozit jeden riadok vystupu. 
Ak vstupne pociatocne natavenie/riesenie nie je riesitelne, vypis riadok PUZZLE NIE SU RIESITELNE. 
Ak su pucle neriesitelne vypis pohyb sekvencii vysvetlene nad vyriesenymi puzlami*/


//Importujeme si všetky kninice, ktoré budeme pouíva
import java.awt.*;
import java.awt.event.*;
import java.awt.image.*;
import javax.swing.*;
import java.util.*;

//Trieda Puzzle bude dedi z triedy JFrame pretoe chceme vytvori okno typu JFrame.
//Trieda Puzzle taktie bude implementovat ActionListener pretoe budeme potrebova udalosti na stlaèenie myši
public class Puzzle extends JFrame implements ActionListener 
{
    //Zadeklarujeme si hlavnı panel, na ktorom bude celá hra prebieha
    private JPanel hlavnıPanel;
    
    //Zadeklarujeme si tlaèidlo, ktoré budeme pouíva
    private JButton tlaèidlo;
    
    //Zadeklarujeme si premennú "zdroj", do ktorej naèítame obrázok
    private Image zdroj;
    
    //Vytvoríme si pole obrázkov, do ktorého budeme uklada posekané kúsky hlavného obrázku
    private Image[] image = new Image[11];
  
    //Premenná "šírkaObrázku" a "vıškaObrázku" budú uchováva údaj o ve¾kosti obrázku
    int šírkaObrázku, vıškaObrázku;
    
    //Pole tlaèidiel, v ktorom bude 12 tlaèidiel, pretoe budeme ma 12 kúskov obrázku
    private JButton[] poleTlacidiel = new JButton[12];
    
    /*Pole, ktoré bude uchováva údaje o tom, èi jednotlivé tlaèidlá majú pridelenı obrázok alebo nie
      Jedno tlaèidlo vdy nebude ma pridelenı obrázok */
    private boolean[] prazdne = new boolean[12];
    
    //Premenná "c" bude pouitá pri naplnení po¾a obrázkov
    int c = 0;
    
    
    //Vytvoríme si konštruktor, ktorı nám nastaví poèiatoèné údaje hry
    public Puzzle() 
    {
        //Vytvoríme si panel, ktorı sme vyššie zadeklarovali
        hlavnıPanel = new JPanel();
        
        //Nastavíme rozloenie panela, prvı údaj bude 4, pretoe budeme ma 4 riadky
        hlavnıPanel.setLayout(new GridLayout(4, 0, 0, 0));
        
        //Naèítame si obrázok do premennej "zdroj"
        ImageIcon kungFuPanda = new ImageIcon(Puzzle.class.getResource("kung_fu_panda.jpg"));
        zdroj = kungFuPanda.getImage();
        
        //Uloíme si šírku a vıšku obrázku do premennıch "šírkaObrázku" a "vıškaObrázku"
        šírkaObrázku = kungFuPanda.getIconWidth();
        vıškaObrázku = kungFuPanda.getIconHeight();

        //Nastavíme vlastnosti panelu, teda okna v ktorom bude prebieha naša hra
        add(hlavnıPanel, BorderLayout.CENTER);
        setSize(600, 660);
        setTitle("Puzzle");
        setResizable(false);
        setLocationRelativeTo(null);
        setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
        setVisible(true);
   
        //Pomocou vnoreného cyklu si posekáme obrázok na 11 kúskov, pravı dolnı roh obrázku necháme prázdny
        //Tıchto 11 kúskov uloíme do po¾a obrázkov
        for ( int i = 0; i < 4; i++) 
        {
            for ( int j = 0; j < 3; j++) 
            {
                if ( j == 2 && i == 3){} 
                else 
                {
                    image[c] = createImage(new FilteredImageSource(zdroj.getSource(),
                               new CropImageFilter(j*šírkaObrázku/3, i*vıškaObrázku/4, 
                              (šírkaObrázku/3)+1, vıškaObrázku/4)));
                    c++;
                }
            }
        }
        
        //Prevedieme si pole obrázkov na kolekciu a pouijeme metódu na pomiešanie prvkov po¾a
        Collections.shuffle(Arrays.asList(image));
        
        //Pomocou cyklu for vytvoríme 12 tlaèidiel, prièom prvım jedenástim priradíme kúsky obrázkov
        //Tlaèidlám prídáme actionListener, ktorı bude naèúva èi boli stlaèené
        //Pridáme tlaèidlá na hlavnı panel
        //Posledné dvanáste tlaèidlo necháme bez obrázku
        for (int i = 0; i < 12; i++)
        {
            if (i == 11)
            {
                poleTlacidiel[i] = new JButton();
                hlavnıPanel.add(poleTlacidiel[i]);
                poleTlacidiel[i].addActionListener(this);
                prazdne[i] = true;
            }
            else
            {
                poleTlacidiel[i] = new JButton();
                poleTlacidiel[i].addActionListener(this);
                prazdne[i] = false;
                hlavnıPanel.add(poleTlacidiel[i]);
                poleTlacidiel[i].setIcon(new ImageIcon(image[i]));
            }
        }
    }

    
    // V metóde main vytvoríme našu hru Puzzle
    public static void main(String[] args) 
    {
        new Puzzle();
    }

    
    //Metóda ktorá obsluhuje kliknutie na tlaèidlo
    public void actionPerformed(ActionEvent e) 
    {
      //Zadeklarujeme si tlaèidlo a do tohto tlaèidla skopírujeme tlaèidlo, ktoré bolo kliknuté  
      JButton tlaèidlo = (JButton) e.getSource();
      
      // Do premennej "skuska" vloíme obrázok tlaèidla, ktoré bolo kliknuté
      Icon skuska; 
      skuska = tlaèidlo.getIcon();
      
      //Premenná "moze" zabezpeèuje to, aby sa nepriradila premenná "prazdne" tlaèidlu, ktoré prázdne nie je
      /*Ak klikneme na tlaèidlo, ktoré sa posunie do prázdneho miesta (do prázdneho miesta sa môu premiestni len tlaèidlá, ktoré sú okolo tohto prázdneho miesta)
        tak sa premenná "moze" zmení na true a to bude signál, aby sa zmenila aj pozícia prázdneho miesta */
      boolean moze = false;
      
      /*Pomocou cyklu prejdeme všetky tlaèidlá, zistíme ktoré z nich je prázdne a ak je tlaèidlo, na ktoré sme klikli niekde okolo tohto prázdneho tlaèidla tak sa 
        nám vymenia obrázky, to znamená, e sa zoberie obrázok z tlaèidla, na ktoré sme klikli a vloí sa do tlaèidla ktoré nemalo iadny obrázok */
      for (int i = 0; i < 12; i++)
      {
          if (prazdne[i] == true)
          { 
              if (((i > 2) && (poleTlacidiel[(i - 3)].equals(tlaèidlo)))||
                 ((((i - 1) != 2) && (i > 0) && ((i - 1) != 5) && ((i - 1) != 8)) && (poleTlacidiel[(i - 1)].equals(tlaèidlo)))||
                 ((i < 9) && (poleTlacidiel[(i + 3)].equals(tlaèidlo)))||
                 ((((i + 1) != 3) && (i < 11) && ((i + 1) != 6) && ((i + 1) != 9)) && (poleTlacidiel[(i + 1)].equals(tlaèidlo))))
                 {
                    poleTlacidiel[i].setIcon(skuska);
                    prazdne[i] = false;
                    tlaèidlo.setIcon(null);
                    moze = true;
                }
          }  
      }
           
      //zistíme, na ktoré tlaèidlo v poli sme klikli, a keï je premenná "moze" nastavená na true tak zmeníme pozíciu prázdneho miesta  
      for (int i = 0; i < 12; i++)
      {
          if ((tlaèidlo).equals(poleTlacidiel[i]) && (moze == true))
          {
              prazdne[i] = true; moze = false;
          }
      }
    }
}